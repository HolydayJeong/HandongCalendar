<head>
</head>
<load target="css/fullcalendar.css"/>
<load target="css/fullcalendar.print.css"/>
<load target="js/fullcalendar.min.js"/>
<script>

function register()
{
	var url = "modules/hgucalendar/tpl/register.html";
	var option = "width=500px, height=500px, resizable=yes, scrollbars=no, status=no;'";
	window.open(url,'',option);
	
	//current_url.setQuery('act','dispBookAdminList').setQuery('module_srl','');
	//if(page) url = url.setQuery('page',page);
	//location.href = url;
}

function event_reg(start, end)
{
	// 형식을 0000-00-00 으로 만들기
	if(start.getMonth()<9){
		if(start.getDate()<9){
			start = start.getFullYear()+"_0"+(start.getMonth()+1)+"_0"+start.getDate();
		}
		else
			start = start.getFullYear()+"_0"+(start.getMonth()+1)+"_"+start.getDate();
	}
	else if(start.getDate()<9){
		start = start.getFullYear()+"_"+(start.getMonth()+1)+"_0"+start.getDate();
	}
	else
		start = start.getFullYear()+"_"+(start.getMonth()+1)+"_"+start.getDate();
	
	if(end.getMonth()<9){
		if(end.getDate()<9){
			end = end.getFullYear()+"_0"+(end.getMonth()+1)+"_0"+end.getDate();
		}
		else
			end = end.getFullYear()+"_0"+(end.getMonth()+1)+"_"+end.getDate();
	}
	else if(end.getDate()<9){
		end = end.getFullYear()+"_"+(end.getMonth()+1)+"_0"+end.getDate();
	}
	else
		end = end.getFullYear()+"_"+(end.getMonth()+1)+"_"+end.getDate();

	location.href="./index.php?mid=CultureCalendar&act=dispHgucalendarContentRegist&start="+start+"&end="+end;
}

(function($){

	$(document).ready(function() {
		var date = new Date();
		var d = date.getDate();
		var m = date.getMonth();
		var y = date.getFullYear();
		
		var calendar = $('#calendar').fullCalendar({
			header: {
				left: 'prev,next today',
				center: 'title',
				right: 'month,agendaWeek,agendaDay'
			},
			selectable: true,
			selectHelper: true,
			select: function(start, end, allDay) {
				//alert(start+" / "+end);
				if(confirm('일정을 등록하시겠습니까?') == true)
					event_reg(start, end);
				else if (title) {
					calendar.fullCalendar('renderEvent',
						{
							title: title,
							start: start,
							end: end,
							allDay: allDay
						},
						true // make the event "stick"
					);
				}
				calendar.fullCalendar('unselect');
			},
			editable: false,
			events: [
				{
					title: 'Click for Google',
					start: new Date('2014-2-10 9:00'),
					end: new Date('2014-2-10 11:00'),
					allDay:false
				},
				{
					title: '바람과 함께 사라지다',
					start: new Date(y, m, 28, 10, 30),
					end: new Date(y, m, 28, 11, 40),
					url: 'http://www.google.co.kr',
					allDay: false
				},
				{
					title: '소소한 일상',
					start: new Date(y, m, 28, 12, 30),
					end: new Date(y, m, 28, 13, 40),
					url: 'http://www.google.co.kr',
					allDay: false
				},
				{
					title: '레미제라블',
					start: new Date(y, m, 29, 10, 30),
					end: new Date(y, m, 29, 11, 40),
					url: 'http://www.google.co.kr',
					allDay: false
				}
			]
		});

		<!--@foreach($eventinfo as $no => $event)-->
		date_mod = '{$event->startdate}';
		date_mod = date_mod.substr(0,8);
		//console.log("date_mod = "+date_mod);
		edate = new Date('{$event->startdate}');
		eday = edate.getDate();
		//console.log("eday = "+eday);

		stime1_1 = '{$event->stime1_1}';
		stime1_1 = date_mod+eday+' '+stime1_1.substr(0,5);
		eventarr = {title: '{$event->eventname}', start: new Date(stime1_1), allDay:false};
		calendar.fullCalendar('renderEvent',eventarr);
		//console.log('stime1_1 = '+stime1_1);
		//console.log('1-2 : {$event->stime1_2}');
		<!--@if($event->stime1_2 != '')-->                   
		stime1_2 = '{$event->stime1_2}';
		stime1_2 = date_mod+eday+' '+stime1_2.substr(0,5);
		calendar.fullCalendar('renderEvent',{title: '{$event->eventname}', start: new Date(stime1_2), allDay:false});
		<!--@end-->

		<!--@if($event->stime2_1 != '')-->
		stime2_1 = '{$event->stime2_1}';
		stime2_1 = date_mod+(eday+1)+' '+stime2_1.substr(0,5);
		calendar.fullCalendar('renderEvent',{title: '{$event->eventname}', start: new Date(stime2_1), allDay:false});
			<!--@if($event->stime2_2 != '')-->
			stime2_2 = '{$event->stime2_2}';
			stime2_2 = date_mod+(eday+1)+' '+stime2_2.substr(0,5);
			calendar.fullCalendar('renderEvent',{title: '{$event->eventname}', start: new Date(stime2_2), allDay:false});
			<!--@end-->

			<!--@if($event->stime3_1 != '')-->
			stime3_1 = '{$event->stime3_1}';
			stime3_1 = date_mod+(eday+2)+' '+stime3_1.substr(0,5);
			calendar.fullCalendar('renderEvent',{title: '{$event->eventname}', start: new Date(stime3_1), allDay:false});
				<!--@if($event->stime3_2 != '')-->
				stime3_2 = '{$event->stime3_2}';
				stime3_2 = date_mod+(eday+2)+' '+stime3_2.substr(0,5);
				calendar.fullCalendar('renderEvent',{title: '{$event->eventname}', start: new Date(stime3_2), allDay:false});
				<!--@end-->

				<!--@if($event->stime4_1 != '')-->
				stime4_1 = '{$event->stime4_1}';
				stime4_1 = date_mod+(eday+3)+' '+stime4_1.substr(0,5);
				console.log(stime4_1);
				calendar.fullCalendar('renderEvent',{title: '{$event->eventname}', start: new Date(stime4_1), allDay:false});
					<!--@if($event->stime4_2 != '')-->
					stime4_2 = '{$event->stime4_2}';
					stime4_2 = date_mod+(eday+3)+' '+stime4_2.substr(0,5);
					calendar.fullCalendar('renderEvent',{title: '{$event->eventname}', start: new Date(stime4_2), allDay:false});
					<!--@end-->

					<!--@if($event->stime5_1 != '')-->
					stime5_1 = '{$event->stime5_1}';
					stime5_1 = date_mod+(eday+4)+' '+stime5_1.substr(0,5);
					calendar.fullCalendar('renderEvent',{title: '{$event->eventname}', start: new Date(stime5_1), allDay:false});
						<!--@if($event->stime5_2 != '')-->
						stime5_2 = '{$event->stime5_2}';
						stime5_2 = date_mod+(eday+4)+' '+stime5_2.substr(0,5);
						calendar.fullCalendar('renderEvent',{title: '{$event->eventname}', start: new Date(stime5_2), allDay:false});
						<!--@end-->
					<!--@end-->
				<!--@end-->

			<!--@end-->
		<!--@end-->

		<!--@end-->

		$('.fc-header-right').append('<span class="fc-button  fc-state-default fc-corner-left fc-corner-right" id="groupreg">단체등록</span>');

		$('#groupreg').click(function(){
			var url = "modules/hgucalendar/tpl/register.html";
			var option = "width=500px, height=500px, resizable=yes, scrollbars=no, status=no;'";
			window.open(url,'',option);
		});
	});
})(jQuery);

</script>
<style>

	body {
		margin-top: 40px;
		text-align: center;
		font-size: 14px;
		font-family: "Lucida Grande",Helvetica,Arial,Verdana,sans-serif;
		}

	#calendar {
		width: 900px;
		margin: 0 auto;
		}

</style>
<div id='calendar'></div>

<!-- 생성 -->
<a href="{getUrl('act','dispHgucalendarContentRegist')}">일정등록</a> 
